SELECT insertxmlbefore('<a><b>b</b></a>','/a/b','<c>c</c>'); SELECT insertxmlbefore('<a><b></b></a>','/a/b','<c>c</c>'); SELECT insertxmlbefore('<a><b></b></a>','/a/b','<c></c>'); SELECT insertxmlbefore('<a xmlns="http://example.com"><b>test</b></a>', '//mydefns:b/text()', '<name>newnode</name>', ARRAY[ARRAY['mydefns', 'http://example.com']]);